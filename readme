optimized for performance using gcc compiler flags magic.
